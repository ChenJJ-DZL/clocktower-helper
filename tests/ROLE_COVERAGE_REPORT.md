# 角色覆盖情况报告

## 概述

当前测试系统主要针对**暗流涌动（Trouble Brewing）**剧本，该剧本共有**22个标准角色**。

## 已实现的角色（10个）

### 镇民（9个）
1. ✅ **洗衣妇** (washerwoman) - 首夜信息
2. ✅ **图书管理员** (librarian) - 首夜信息
3. ✅ **调查员** (investigator) - 首夜信息
4. ✅ **厨师** (chef) - 首夜信息
5. ✅ **共情者** (empath) - 每夜信息
6. ✅ **占卜师** (fortune_teller) - 每夜查验
7. ✅ **僧侣** (monk) - 每夜保护
8. ✅ **士兵** (soldier) - 被动保护（恶魔无法杀死）
9. ✅ **茶女** (tea_lady) - 被动保护（邻座善良玩家）

### 爪牙（1个）
1. ✅ **投毒者** (poisoner, poisoner_mr) - 每夜投毒

### 恶魔（1个）
1. ✅ **小恶魔** (imp) - 每夜杀人（部分实现，只实现了基本杀人逻辑）

## 未实现的角色（12个）

### 镇民（4个）
1. ❌ **送葬者** (undertaker) - 非首夜得知今天被处决并死亡的玩家角色
2. ❌ **守鸦人** (ravenkeeper) - 夜晚死亡时唤醒，选择一名玩家，得知其真实角色
3. ❌ **贞洁者** (virgin) - 首次被镇民提名的瞬间，提名者被处决
4. ❌ **猎手** (slayer) - 白天可指定一名玩家，若为恶魔，恶魔死
5. ❌ **镇长** (mayor) - 若仅剩3人且无人被处决，好人获胜

### 外来者（4个）
1. ❌ **管家** (butler) - 每晚选择一名主人，必须投票给主人
2. ⚠️ **酒鬼** (drunk) - 已处理初始化，但未测试其"误以为自己是镇民"的技能效果
3. ❌ **陌客** (recluse) - 判定阵营时可能被视为邪恶/爪牙/恶魔
4. ❌ **圣徒** (saint) - 若死于处决，邪恶方立即获胜

### 爪牙（3个）
1. ❌ **间谍** (spy) - 每晚查看魔典（所有真实身份）和完整行动日志
2. ❌ **红唇女郎** (scarlet_woman) - 若恶魔死时活人>=5，她变恶魔
3. ❌ **男爵** (baron) - Setup阶段增加2个外来者替换镇民

## 覆盖率统计

- **总角色数**: 22个
- **已实现**: 10个（45.5%）
- **未实现**: 12个（54.5%）

### 按类型分类

| 类型 | 总数 | 已实现 | 未实现 | 覆盖率 |
|------|------|--------|--------|--------|
| 镇民 | 13 | 9 | 4 | 69.2% |
| 外来者 | 4 | 0 | 4 | 0% |
| 爪牙 | 4 | 1 | 3 | 25% |
| 恶魔 | 1 | 1* | 0 | 100%* |

*注：恶魔只实现了基本杀人逻辑，未实现小恶魔的特殊能力（自杀死爪牙变恶魔）

## 建议

### 高优先级（核心角色）
1. **送葬者** - 重要的信息角色
2. **守鸦人** - 重要的信息角色
3. **贞洁者** - 重要的触发角色
4. **猎手** - 重要的白天能力
5. **圣徒** - 重要的游戏结束条件

### 中优先级
6. **管家** - 投票限制机制
7. **间谍** - 查看魔典能力
8. **红唇女郎** - 变身机制
9. **镇长** - 游戏结束条件

### 低优先级
10. **陌客** - 被动能力，主要影响信息判定
11. **男爵** - Setup阶段修改，影响游戏初始化
12. **酒鬼** - 需要完善其"误以为自己是镇民"的逻辑测试

## 注意事项

1. 当前测试主要覆盖了**首夜信息角色**和**每夜行动角色**，但缺少：
   - 白天能力角色（猎手）
   - 触发式角色（贞洁者、守鸦人、圣徒）
   - 被动能力角色（镇长、陌客）
   - Setup阶段角色（男爵）

2. 测试中的角色技能实现较为简化，主要用于验证游戏流程，可能无法完全覆盖所有边界情况。

3. 建议逐步添加未实现的角色，优先添加核心角色以提升测试覆盖率。

