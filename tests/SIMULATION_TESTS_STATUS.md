# 游戏模拟测试系统状态

## 已完成

1. ✅ **基础模板** (`simulation_base.js`)
   - 包含所有通用函数（随机选择、阵营判断、状态快照等）
   - 包含日志生成函数

2. ✅ **暗流涌动完整测试** (`simulation_trouble_brewing.test.js`)
   - 包含所有22个角色的完整能力实现
   - 夜晚能力：洗衣妇、图书管理员、调查员、厨师、共情者、占卜师、送葬者、僧侣、守鸦人、管家、投毒者、间谍、小恶魔
   - 白天能力：猎手、贞洁者、圣徒
   - 触发式能力：守鸦人（夜晚死亡）、贞洁者（被提名）、圣徒（被处决）
   - 被动能力：士兵、镇长、红唇女郎
   - 已测试运行正常

## 待创建

3. ⏳ **暗月初升完整测试** (`simulation_bad_moon_rising.test.js`)
   - 需要实现所有角色（约25个）
   - 包括：祖母、水手、侍女、驱魔人、旅店老板、赌徒、造谣者、侍臣、教授、吟游诗人、茶艺师、和平主义者、弄臣
   - 外来者：修补匠、月之子、莽夫、疯子
   - 爪牙：教父、魔鬼代言人、刺客、主谋
   - 恶魔：僵怖、普卡、沙巴洛斯、珀

4. ⏳ **梦殒春宵完整测试** (`simulation_sects_violets.test.js`)
   - 需要实现所有角色（约25个）
   - 包括：钟表匠、筑梦师、舞蛇人、数学家、卖花女孩、城镇公告员、神谕者、博学者、女裁缝、哲学家、艺术家、杂耍艺人、贤者
   - 外来者：畸形秀演员、心上人、理发师、呆瓜
   - 爪牙：镜像双子、女巫、洗脑师、麻脸巫婆
   - 恶魔：方古、亡骨魔、诺-达鲺、涡流

5. ⏳ **夜半狂欢完整测试** (`simulation_midnight_revelry.test.js`)
   - 需要实现所有角色（约25个）
   - 角色列表待确认

6. ⏳ **完整角色库测试** (`simulation_all_roles.test.js`)
   - 包含所有剧本的所有角色
   - 从所有角色中随机选择

## 每个测试文件需要实现的能力类型

### 1. 夜晚能力
- 首夜信息角色（如洗衣妇、图书管理员等）
- 每夜信息角色（如共情者、占卜师等）
- 每夜行动角色（如投毒者、僧侣等）
- 每夜选择角色（如管家、水手等）

### 2. 白天能力
- 主动能力（如猎手射击、造谣者声明等）
- 投票相关（如管家跟随主人投票）

### 3. 触发式能力
- 死亡触发（如守鸦人、贤者等）
- 提名触发（如贞洁者）
- 处决触发（如圣徒）

### 4. 被动能力
- 保护能力（如士兵、茶女等）
- 游戏结束条件（如镇长、主谋等）
- 变身能力（如红唇女郎、方古等）

## 运行方式

```bash
# 暗流涌动
npm run test:simulation:tb

# 暗月初升（待创建）
npm run test:simulation:bmr

# 梦殒春宵（待创建）
npm run test:simulation:sv

# 夜半狂欢（待创建）
npm run test:simulation:mr

# 完整角色库（待创建）
npm run test:simulation:all
```

## 输出

每个测试会生成：
- 控制台输出：每局游戏摘要
- 详细日志文件：`tests/simulation_logs/{剧本名}/game_XXX.log`
- 汇总报告：`tests/simulation_logs/{剧本名}/summary.txt`

## 下一步

1. 继续创建其他4个测试文件
2. 为每个剧本实现所有角色的完整能力
3. 测试并验证所有测试文件运行正常

